<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Manajemen Pekerjaan</title>

<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
:root{
  --bg:#f0f2f5;--card:#fff;--text:#222;--primary:#1e3c72;
}
body.dark{
  --bg:#121212;--card:#1e1e1e;--text:#f5f5f5;
}
*{box-sizing:border-box;font-family:"Segoe UI",Arial}
body{margin:0;background:var(--bg);color:var(--text);transition:.3s}
header{background:var(--primary);color:white;padding:20px;text-align:center;font-size:24px}
.container{max-width:1100px;margin:20px auto;padding:15px}
.card{background:var(--card);border-radius:15px;padding:20px;box-shadow:0 10px 25px rgba(0,0,0,.15)}
.top{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px}
input,select{padding:10px;border-radius:8px;border:1px solid #ccc}
button{padding:10px 14px;border:none;border-radius:8px;background:var(--primary);color:white;cursor:pointer}
.toggle{cursor:pointer;font-size:20px}

.stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;margin:15px 0}
.stat{background:rgba(0,0,0,.05);padding:15px;border-radius:12px;text-align:center}

table{width:100%;border-collapse:collapse;margin-top:15px}
th,td{padding:12px;border-bottom:1px solid #ccc}
th{background:rgba(0,0,0,.05)}

.status{padding:5px 10px;border-radius:20px;font-size:12px;color:white}
.aktif{background:#4caf50}
.selesai{background:#777}

.modal{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;justify-content:center;align-items:center}
.modal-box{background:var(--card);padding:25px;border-radius:15px;width:320px}
.modal-box input,.modal-box select{width:100%;margin-bottom:10px}
</style>
</head>

<body>

<header>Manajemen Pekerjaan</header>

<div class="container">
<div class="card">

<div class="top">
<h2>ðŸ“‹ Data Pekerjaan</h2>
<div>
<span class="toggle" onclick="toggleDark()">ðŸŒ™</span>
<button onclick="openModal()">âž• Pekerjaan</button>
</div>
</div>

<div class="stats">
<div class="stat"><h3 id="aktif">0</h3>Aktif</div>
<div class="stat"><h3 id="selesai">0</h3>Selesai</div>
</div>

<table>
<thead>
<tr>
<th>Nama</th>
<th>Pekerjaan</th>
<th>Deadline</th>
<th>Prioritas</th>
<th>Status</th>
<th>Aksi</th>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>

</div>
</div>

<!-- MODAL -->
<div class="modal" id="modal">
<div class="modal-box">
<h3>Tambah Pekerjaan</h3>
<input id="nama" placeholder="Nama karyawan">
<input id="judul" placeholder="Nama pekerjaan">
<input type="date" id="deadline">
<select id="prioritas">
<option>Rendah</option>
<option>Sedang</option>
<option>Tinggi</option>
</select>
<button onclick="simpan()">Simpan</button>
</div>
</div>

<script>
firebase.initializeApp({
  apiKey: "AIzaSyBjDHapatmMS4C2EDFXxp_WQXVhb0UCZZg",
  authDomain: "web-usaha-ivan.firebaseapp.com",
  projectId: "web-usaha-ivan"
});

const db = firebase.firestore();
const tbody = document.getElementById("tbody");

function render(){
db.collection("pekerjaan").orderBy("createdAt","desc")
.onSnapshot(snap=>{
tbody.innerHTML="";
let a=0,s=0;
snap.forEach(doc=>{
const d=doc.data();
if(d.status==="Aktif")a++; else s++;
tbody.innerHTML+=`
<tr>
<td>${d.nama}</td>
<td>${d.judul}</td>
<td>${d.deadline||"-"}</td>
<td>${d.prioritas}</td>
<td><span class="status ${d.status==="Aktif"?"aktif":"selesai"}">${d.status}</span></td>
<td>
<button onclick="toggle('${doc.id}','${d.status}')">ðŸ”„</button>
<button onclick="hapus('${doc.id}')">ðŸ—‘</button>
</td>
</tr>`;
});
aktif.innerText=a; selesai.innerText=s;
});
}

function simpan(){
db.collection("pekerjaan").add({
nama:nama.value,
judul:judul.value,
deadline:deadline.value,
prioritas:prioritas.value,
status:"Aktif",
createdAt:firebase.firestore.FieldValue.serverTimestamp()
});
modal.style.display="none";
}

function toggle(id,status){
db.collection("pekerjaan").doc(id).update({
status:status==="Aktif"?"Selesai":"Aktif"
});
}

function hapus(id){
if(confirm("Hapus pekerjaan?")){
db.collection("pekerjaan").doc(id).delete();
}
}

function openModal(){modal.style.display="flex"}
window.onclick=e=>{if(e.target===modal)modal.style.display="none"}
function toggleDark(){document.body.classList.toggle("dark")}

render();
</script>

</body>
</html>
