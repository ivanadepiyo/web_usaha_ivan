<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard | Web Perusahaan</title>

<style>
body{
  font-family:"Segoe UI",Arial,sans-serif;
  margin:0;
  background:#f0f2f5;
  min-height:100vh;
  display:flex;
  flex-direction:column;
}

/* HEADER */
header{
  background:#1e3c72;
  color:white;
  padding:20px;
  text-align:center;
  font-size:24px;
}

/* CONTAINER */
.container{
  max-width:600px;
  margin:30px auto;
  background:white;
  border-radius:12px;
  padding:25px;
  box-shadow:0 10px 25px rgba(0,0,0,0.12);
  text-align:center;
}

/* BUTTON */
button{
  display:block;
  width:85%;
  margin:12px auto;
  padding:13px 20px;
  border:none;
  border-radius:10px;
  background:#1e3c72;
  color:white;
  font-weight:bold;
  cursor:pointer;
  font-size:16px;
  transition:0.2s;
}
button:hover{ background:#15509c; }

#logoutBtn{
  background:#d9534f;
}
#logoutBtn:hover{
  background:#c9302c;
}

/* MODAL */
.modal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.55);
  justify-content:center;
  align-items:center;
  z-index:1000;
}
.modal-content{
  background:white;
  padding:22px;
  border-radius:12px;
  text-align:center;
  width:300px;
}
.modal-content input{
  width:90%;
  padding:10px;
  margin-top:10px;
  border-radius:8px;
  border:1px solid #ccc;
  font-size:16px;
}

/* FOOTER */
footer{
  margin-top:auto;
  background:#fff;
  padding:12px;
  text-align:center;
  font-size:13px;
  color:#555;
  border-top:1px solid #eee;
}
</style>
</head>

<body>

<header>Dashboard Web Perusahaan</header>

<div class="container">
  <h2>Menu Akses Admin</h2>

  <button id="btnDataDiri">Data Diri</button>
  <button id="btnPerusahaan">Perusahaan</button>
  <button id="btnGaji">Daftar Gaji</button>
  <button id="btnPekerjaan">Pekerjaan</button>
  <button id="btnKalkulator">Kalkulator</button>
  <button id="btnBukuCatatan">Buku Catatan</button>

  <button id="logoutBtn">Logout</button>
</div>

<!-- MODAL KODE -->
<div id="modalKode" class="modal">
  <div class="modal-content">
    <h3>Masukkan Kode Akses</h3>
    <input type="password" id="inputKode" placeholder="Kode Akses">
    <button id="submitKode">Buka Halaman</button>
  </div>
</div>

<!-- FOOTER LOGIN TERAKHIR -->
<footer>
  <span id="lastLogin">Login terakhir: -</span>
</footer>

<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyBjDHapatmMS4C2EDFXxp_WQXVhb0UCZZg",
  authDomain: "web-usaha-ivan.firebaseapp.com",
  projectId: "web-usaha-ivan",
  storageBucket: "web-usaha-ivan.appspot.com",
  messagingSenderId: "588839561784",
  appId: "1:588839561784:web:4accd7d9316a5a0ec5d4cd"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();

/* CEK LOGIN */
auth.onAuthStateChanged(user=>{
  if(!user){
    window.location.href="login.html";
    return;
  }

  // TAMPILKAN LOGIN TERAKHIR DI BAWAH
  const lastLogin = new Date(user.metadata.lastSignInTime);
  document.getElementById("lastLogin").textContent =
    "Login terakhir: " + lastLogin.toLocaleString("id-ID");
});

/* LOGOUT */
document.getElementById("logoutBtn").onclick = ()=>{
  auth.signOut().then(()=>window.location.href="login.html");
};

/* HALAMAN TANPA KODE */
btnDataDiri.onclick = ()=>location.href="DataDiri.html";
btnKalkulator.onclick = ()=>location.href="kalkulator.html";
btnBukuCatatan.onclick = ()=>location.href="BukuCatatan.html";

/* MODAL */
const modal = document.getElementById("modalKode");
const inputKode = document.getElementById("inputKode");
let targetPage="";

function bukaModal(page){
  targetPage = page;
  inputKode.value="";
  modal.style.display="flex";
  inputKode.focus();
}

btnPerusahaan.onclick = ()=>bukaModal("Perusahaan.html");
btnGaji.onclick = ()=>bukaModal("Gaji.html");
btnPekerjaan.onclick = ()=>bukaModal("Pekerjaan.html");

submitKode.onclick = ()=>{
  if(inputKode.value === "1234"){
    location.href = targetPage;
  }else{
    alert("Kode akses salah!");
  }
  modal.style.display="none";
};

window.onclick = e=>{
  if(e.target === modal) modal.style.display="none";
};
</script>

</body>
</html>
